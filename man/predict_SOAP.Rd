% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pred_soap.R
\name{predict_SOAP}
\alias{predict_SOAP}
\title{This function computes the predicted trajectories based on etimated FECs and sparse observatios using the SOAP method}
\usage{
predict_SOAP(betalist, ylist, tlist, spline_basis, nminus = 2)
}
\arguments{
\item{betalist}{a list of all the FECs' coefficients}

\item{ylist}{a list of observed longtitudinal data; each element in the list is a numeric vector for one subject's observed data}

\item{tlist}{a list of observed time points}

\item{spline_basis}{the B-spline basis for the fitted FEC}

\item{nminus}{the total number of FECs in the betalist -  nminus is the number of FECs used for predicting the individual's trajectory}
}
\description{
This function computes the predicted trajectories based on etimated FECs and sparse observatios using the SOAP method
}
\examples{
\dontrun{
library(fda)
library(cFuSIM)
data(bike_cFuSIM)
timepts = bike$timepts
norder=4 ## cubic B-spline
nbasis=norder+length(timepts)-2; 
spline_basis=create.bspline.basis(rangeval=c(1,24),nbasis#'norder,timepts)
wull = bike$temp
xfds=  Data2fd(y=wull\%>\%t, argvals=bike$timepts)
y = bike$y
train_sample = 1:length(y)
y = y[train_sample]
xfd = xfds[train_sample]
res_c = cFuSIM_index(y, xfd, spline_basis)
beta_fd = fd(res_c$coefBeta, res_c$basisBeta)
plot(beta_fd,ylab="index function", xlab='time')
fdagg(beta_fd)
score_fit = (res_c$score_fit)
pred_y = localpoly.reg(score_fit, y, degree.pol = 1, kernel.type = "gaussian",bandwidth = "CV",deriv=0,points#'score_fit)
plot(x=score_fit, y=y)
lines(pred_y$predicted[order(score_fit)],x=score_fit[order#'score_fit)],col=4)
}
}
